# PYTHONPATH must include directory above plugin directory.
#     Define either externally or here, then import plugin.
sys.path.insert(0, './..')
import ugamp

molecule {
0 1
 O     -0.028962160801    -0.694396279686    -0.049338350190
 O      0.028962160801     0.694396279686    -0.049338350190
 H      0.350498145881    -0.910645626300     0.783035421467
 H     -0.350498145881     0.910645626300     0.783035421467
symmetry c1
}

set {
  freeze_core true
  basis aug-cc-pVDZ
  maxiter 1000
  restart false
#  r_convergence 1e-15
#  e_convergence 1e-15
#  omega [589, nm]
#  gauge both
#  frozen_uocc [0]
#  num_frzv 0
#  occ_tol 1e-3
#  occ_tolerance 1e-3
#  spatial_tol 9.0
}

#energy('ccsd')

#set fvmo true
#set freeze_type multi_orb
#set multi_orb diplen
#set num_frzv 5
#energy('ugamp',wfn='mp2')
#psi4.set_global_option('WFN', 'CCSD')
#mints = psi4.MintsHelper()
#mints.integrals()
#psi4.transqt2()
#psi4.ccsort()
#psi4.ccenergy()
#
#table = Table(rows=("\# Frozen MO"), cols=("LEN", "MVG"))
table = Table(rows=("\# Frozen NO"), cols=("Polarizability"))

for x in range(0, 31):
    set fvno true
    set freeze_type multi_orb
    set multi_orb diplen
    set num_frzv $x   
    energy('ugamp',wfn='mp2')
    psi4.set_global_option('WFN', 'CCSD')
    psi4.set_global_option('DERTYPE', 'RESPONSE')
    psi4.set_global_option('PROPERTY', 'POLARIZABILITY')
#    psi4.set_global_option('PROPERTY', 'ROTATION')
    mints = psi4.MintsHelper()
    mints.integrals()
    psi4.transqt2()
    psi4.ccsort()
    psi4.ccenergy()
    psi4.cchbar()
    psi4.cclambda()
    psi4.ccresponse()
    polar = get_variable("CCSD Dipole Polarizability")*3.0
#    len = get_variable("CCSD Specific Rotation (LEN)")
#    mvg = get_variable("CCSD Specific Rotation (MVG)")
    clean()
    table[x] = [polar]
#    table[x] = [len, mvg]

print_out(str(table))

