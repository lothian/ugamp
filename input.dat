# PYTHONPATH must include directory above plugin directory.
#     Define either externally or here, then import plugin.
sys.path.insert(0, './..')
import ugamp

molecule {
0 1
 O     -0.028962160801    -0.694396279686    -0.049338350190
 O      0.028962160801     0.694396279686    -0.049338350190
 H      0.350498145881    -0.910645626300     0.783035421467
 H     -0.350498145881     0.910645626300     0.783035421467
symmetry c1
}

set {
  freeze_core false
  basis aug-cc-pVDZ
#  r_convergence 1e-15
#  e_convergence 1e-15
  maxiter 1000
  ooc true
  fvno true
  omega [589, nm]
#  gauge both
#  frozen_uocc [0]
#  num_frzv 0
  nat_orbs true
#  occ_tolerance 0.000002
}

table = Table(rows=("\# Frozen Virtuals"), cols=("Unperturbed", "Canonical"))

for x in range(0, 10):
    set frozen_uocc [$x]
    set num_frzv $x   
    property('ccsd',properties=['polarizability'])
    canpolar = get_variable("CCSD Dipole Polarizability")*3.0
    clean()
    energy('ugamp',wfn='mp2')
    psi4.set_global_option('WFN', 'CCSD')
    psi4.set_global_option('DERTYPE', 'RESPONSE')
    psi4.set_global_option('PROPERTY', 'POLARIZABILITY')
    mints = psi4.MintsHelper()
    mints.integrals()
    psi4.transqt2()
    psi4.ccsort()
    psi4.ccenergy()
    psi4.cchbar()
    psi4.cclambda()
    psi4.ccresponse()
    fvnopolar = get_variable("CCSD Dipole Polarizability")*3.0
    clean()
    table[x] = [fvnopolar, canpolar]

print_out(str(table))


#energy('ccsd')
#energy('fno-ccsd')

